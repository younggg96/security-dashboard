export interface Vulnerability {
  cveId: string;
  severity: string;
  kaiStatus: string;
  cvss: number;
  summary: string;
  publishedDate: string;
  lastModifiedDate: string;
  vulnerable_version: string;
  patched_version: string;
  vendor: string;
  product: string;
  exploitabilityScore: number;
  impactScore: number;
  vulnerabilityType: string;
  cweId: string;
  references: string[];
  tags?: string[];
}

export interface JsonVulnerability {
  cve: string;
  severity: string;
  cvss: number;
  status: string;
  cause?: string;
  description: string;
  vecStr?: string;
  exploit?: string;
  riskFactors?: Record<string, any>;
  link?: string;
  type?: string;
  packageName?: string;
  packageVersion?: string;
  packageType?: string;
  layerTime?: string;
  published: string;
  fixDate?: string;
  applicableRules?: string[];
  owner?: string;
  advisoryType?: string;
  path?: string;
}

// 新增：上传JSON的整体结构
export interface UploadedJsonStructure {
  name: string;
  groups: Record<string, {
    name: string;
    repos: Record<string, {
      name: string;
      images: Record<string, {
        name: string;
        version: string;
        baseImage: string;
        buildType: string;
        maintainer: string;
        createTime: string;
        vulnerabilities: JsonVulnerability[];
        exposedPorts?: any[];
        exposed?: boolean;
        metadata?: Record<string, any>;
      }>;
    }>;
  }>;
}

export interface FilterOptions {
  severity: string[];
  kaiStatus: string[];
  vendor: string[];
  product: string[];
  vulnerabilityType: string[];
  dateRange: {
    start: string | null;
    end: string | null;
  };
  cvssRange: {
    min: number;
    max: number;
  };
}

export interface VulnerabilityStats {
  totalCount: number;
  severityDistribution: Record<string, number>;
  kaiStatusDistribution: Record<string, number>;
  vendorDistribution: Record<string, number>;
  vulnerabilityTypeDistribution: Record<string, number>;
  timelineData: Array<{ date: string; count: number }>;
}

export interface VulnerabilityTableData {
  items: Vulnerability[];
  totalCount: number;
  page: number;
  pageSize: number;
} 